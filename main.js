/* main.js - clean implementation isolating new modal system (no legacy) */
(function(){
  function showToast(message,{duration=2200}={}){let h=document.querySelector('.toast-host');if(!h){h=document.createElement('div');h.className='toast-host';h.style.cssText='position:fixed;bottom:24px;left:50%;transform:translateX(-50%);display:flex;flex-direction:column;gap:8px;z-index:2000000;pointer-events:none;';document.body.appendChild(h);}const el=document.createElement('div');el.className='toast';el.style.cssText='background:rgba(0,0,0,.8);color:#fff;padding:10px 16px;font-size:.8rem;border-radius:8px;box-shadow:0 4px 16px -4px rgba(0,0,0,.6);letter-spacing:.03em;opacity:0;transform:translateY(6px);transition:opacity .35s,transform .35s cubic-bezier(.22,.61,.36,1);backdrop-filter:blur(6px);';el.textContent=message;h.appendChild(el);requestAnimationFrame(()=>{el.style.opacity='1';el.style.transform='translateY(0)';});setTimeout(()=>{el.style.opacity='0';el.style.transform='translateY(6px)';setTimeout(()=>el.remove(),400);},duration);}  
  function initializeHeaderEffects(){const header=document.querySelector('header');if(!header)return;window.addEventListener('scroll',()=>header.classList.toggle('scrolled',window.scrollY>20));}
  function initializeCarousels(){const tracks=document.querySelectorAll('[data-track]');const isTouch='ontouchstart'in window||navigator.maxTouchPoints>0;tracks.forEach(track=>{const name=track.dataset.track;const container=track.parentElement;const cards=track.querySelectorAll('.netflix-card');const prev=document.querySelector(`[data-carousel="${name}"][data-direction="prev"]`);const next=document.querySelector(`[data-carousel="${name}"][data-direction="next"]`);const useNative=isTouch||window.innerWidth<=820;if(useNative){track.style.transform='none';prev&&(prev.style.display='none');next&&(next.style.display='none');return;}let current=0;const cardWidth=336;const maxIndex=()=>Math.max(0,cards.length-Math.floor(container.offsetWidth/cardWidth));let max=maxIndex();function update(){track.style.transform=`translateX(${-current*cardWidth}px)`;prev&&(prev.disabled=current===0);next&&(next.disabled=current>=max);}update();prev&&prev.addEventListener('click',()=>{current=Math.max(0,current-1);update();});next&&next.addEventListener('click',()=>{current=Math.min(max,current+1);update();});window.addEventListener('resize',()=>{if(isTouch||window.innerWidth<=820){track.style.transform='none';prev&&(prev.style.display='none');next&&(next.style.display='none');return;}else{prev&&(prev.style.display='');next&&(next.style.display='');}max=maxIndex();if(current>max)current=max;update();});});}
  class ProjectDetailManager{constructor(){this.current=null;this.lastFocus=null;this.projectOrder=this.computeOrder();this.buildModal();window.addEventListener('hashchange',()=>this.onHashChange());this.live=document.createElement('div');this.live.className='sr-only';this.live.setAttribute('aria-live','polite');document.body.appendChild(this.live);}computeOrder(){return Array.from(document.querySelectorAll('.netflix-card[data-project]')).map(c=>c.dataset.project);}buildModal(){const modal=document.createElement('div');modal.className='project-modal';modal.setAttribute('aria-hidden','true');modal.innerHTML=`<div class="project-modal-overlay"><div class="project-modal-content"><div class="project-nav-bar" style="position:absolute;top:12px;left:12px;display:flex;gap:.5rem;z-index:5;"><button class="project-nav-btn prev" aria-label="Previous project">◀</button><button class="project-nav-btn next" aria-label="Next project">▶</button><span class="project-progress" style="padding:.35rem .6rem;font-size:.7rem;background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.15);border-radius:999px;">1 / 1</span><button class="project-copy" aria-label="Copy link" style="font-size:.75rem;padding:.35rem .6rem;border-radius:6px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.08);">🔗</button></div><button class="project-close" aria-label="Close" style="position:absolute;top:12px;right:12px;background:rgba(255,255,255,.1);border:none;border-radius:50%;width:40px;height:40px;cursor:pointer;">✕</button><div class="project-modal-body" tabindex="0" style="overflow:auto;height:100%;padding:4.5rem 1.5rem 2rem;"></div></div></div>`;document.body.appendChild(modal);this.modal=modal;this.bind();}bind(){this.modal.addEventListener('click',e=>{if(e.target.classList.contains('project-modal-overlay')||e.target.closest('.project-close'))this.close();});document.addEventListener('keydown',e=>{if(!this.isOpen())return;if(e.key==='Escape'){e.preventDefault();this.close();}if(e.key==='ArrowLeft'){e.preventDefault();this.navigate(-1);}if(e.key==='ArrowRight'){e.preventDefault();this.navigate(1);}});this.modal.querySelector('.project-nav-btn.prev').addEventListener('click',()=>this.navigate(-1));this.modal.querySelector('.project-nav-btn.next').addEventListener('click',()=>this.navigate(1));this.modal.querySelector('.project-copy').addEventListener('click',()=>this.copyLink());}isOpen(){return this.modal.classList.contains('active');}onHashChange(){const id=location.hash.startsWith('#project-')?location.hash.slice(9):'';if(!id){if(this.isOpen())this.close();return;}if(id===this.current)return;const card=document.querySelector(`.netflix-card[data-project="${id}"]`);this.open(id,card);}showProjectDetail(id,card){const hash=`project-${id}`;if(location.hash!==`#${hash}`){location.hash=hash;}else{this.open(id,card);}}open(id,card){const data=this.getProjectData(id,card);if(!data)return;this.current=id;const nav=this.modal.querySelector('.project-nav-bar');if(nav)nav.style.display='flex';const body=this.modal.querySelector('.project-modal-body');body.innerHTML=this.renderProject(data);this.modal.classList.add('active');this.modal.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';this.updateProgress();this.updateNavButtons();this.ensureQrButton();this.lastFocus=document.activeElement instanceof HTMLElement?document.activeElement:null;const first=body.querySelector('a,button,[tabindex="0"]');first&&first.focus({preventScroll:true});this.announce(`Opened project ${data.title}`);}close(){this.modal.classList.remove('active');this.modal.setAttribute('aria-hidden','true');document.body.style.overflow='';if(this.lastFocus)this.lastFocus.focus({preventScroll:true});if(location.hash.startsWith('#project-')||location.hash.startsWith('#cert-'))history.replaceState(null,'',location.pathname+location.search);this.current=null;}navigate(dir){if(!this.current)return;const idx=this.projectOrder.indexOf(this.current);const nextIdx=idx+dir;if(nextIdx<0||nextIdx>=this.projectOrder.length)return;const nextId=this.projectOrder[nextIdx];const card=document.querySelector(`.netflix-card[data-project="${nextId}"]`);this.showProjectDetail(nextId,card);}updateProgress(){const prog=this.modal.querySelector('.project-progress');if(!prog||!this.current)return;const idx=this.projectOrder.indexOf(this.current);prog.textContent=`${idx+1} / ${this.projectOrder.length}`;}updateNavButtons(){const prev=this.modal.querySelector('.project-nav-btn.prev');const next=this.modal.querySelector('.project-nav-btn.next');const idx=this.projectOrder.indexOf(this.current);prev.disabled=idx<=0;next.disabled=idx>=this.projectOrder.length-1;[prev,next].forEach(b=>b.style.opacity=b.disabled?'.35':'1');}copyLink(){if(!this.current)return;const url=location.origin+location.pathname+`#project-${this.current}`;navigator.clipboard.writeText(url).then(()=>{showToast('Link copied');this.announce('Link copied');}).catch(()=>showToast('Copy failed'));}ensureQrButton(){if(this.modal.querySelector('.project-qr-btn'))return;const bar=this.modal.querySelector('.project-nav-bar');const btn=document.createElement('button');btn.type='button';btn.className='project-qr-btn';btn.textContent='QR';btn.setAttribute('aria-label','Show QR code');btn.style.cssText='font-size:.7rem;padding:.35rem .55rem;border-radius:6px;border:1px solid rgba(255,255,255,.15);background:rgba(255,255,255,.08);';btn.addEventListener('click',()=>this.showQr());bar.appendChild(btn);}showQr(){if(!this.current)return;const share=encodeURIComponent(location.origin+location.pathname+`#project-${this.current}`);const qr=`https://api.qrserver.com/v1/create-qr-code/?size=220x220&data=${share}`;let o=document.querySelector('.qr-overlay');if(!o){o=document.createElement('div');o.className='qr-overlay';o.style.cssText='position:fixed;inset:0;background:rgba(0,0,0,.65);display:flex;align-items:center;justify-content:center;z-index:2000001;';o.innerHTML=`<div class=\"qr-box\" style=\"background:#111;padding:1.2rem 1.4rem 1.4rem;border-radius:14px;position:relative;box-shadow:0 8px 32px -8px rgba(0,0,0,.7);text-align:center;max-width:280px;\"><button class=\"qr-close\" aria-label=\"Close\" style=\"position:absolute;top:6px;right:6px;background:rgba(255,255,255,.12);border:none;color:#fff;width:30px;height:30px;border-radius:50%;cursor:pointer;\">✕</button><h3 style=\"margin:0 0 .75rem;font-size:.9rem;letter-spacing:.05em;font-weight:600;\">Share Project</h3><img class=\"qr-img\" src=\"${qr}\" alt=\"QR code\" style=\"width:220px;height:220px;border-radius:8px;background:#000;object-fit:contain;\"/><p style=\"margin:.7rem 0 0;font-size:.65rem;line-height:1.2;color:#aaa;\">Scan on your phone<br><span style=\"color:#fff;\">${this.current}</span></p></div>`;document.body.appendChild(o);o.addEventListener('click',e=>{if(e.target===o)o.remove();});o.querySelector('.qr-close').addEventListener('click',()=>o.remove());}else{o.querySelector('.qr-img').src=qr;const span=o.querySelector('span');span&&(span.textContent=this.current);}showToast('QR code ready');}announce(msg){if(this.live){this.live.textContent='';requestAnimationFrame(()=>{this.live.textContent=msg;});}}getProjectData(id,card){if(!this._data)this._data=this.staticData();if(this._data[id])return this._data[id];if(card){const title=card.querySelector('.netflix-card-title')?.textContent?.trim()||id;const desc=card.querySelector('.netflix-card-description')?.textContent?.trim()||'';return{id,title,subtitle:'Project',image:card.querySelector('img')?.src||'',description:desc,longDescription:desc,metrics:[],technologies:[],features:[],architecture:{title:'Architecture',description:'',components:[]},github:null,demo:null};}return null;}staticData(){return{'financial-risk':{title:'📈 GPU-Accelerated Financial Risk Analysis',subtitle:'CUDA Monte Carlo / VaR',image:'https://images.unsplash.com/photo-1611974789855-9c2a0a7236a3?auto=format&fit=crop&w=1200&q=80',description:'GPU-accelerated risk simulation.',longDescription:'Advanced risk assessment with CUDA-parallel Monte Carlo simulations comparing CPU vs GPU performance.',metrics:[{label:'Speedup',value:'1.57×',icon:'🚀'}],technologies:[{name:'CUDA'},{name:'PyCUDA'},{name:'NumPy'}],features:['Monte Carlo engine','VaR computation','Performance benchmarking'],architecture:{title:'System Architecture',description:'GPU kernel + analysis pipeline',components:['CUDA Kernels','Simulation Runner','Result Analyzer']},github:'https://github.com/saiprudvi0102/Finance-Risk-Analysis-GPU',demo:null},'mobilellm':{title:'📱 Edge-Deployed Mobile LLM Pipeline',subtitle:'Quantization / On-Device AI',image:'https://images.unsplash.com/photo-1510557880182-3d4d3cba35a5?auto=format&fit=crop&w=1200&q=80',description:'Deploying compressed transformer models to mobile hardware.',longDescription:'Built an optimized on-device inference stack: model pruning, 8-bit quantization, operator fusion and memory-mapped weights for low-latency mobile responses.',metrics:[{label:'Latency',value:'<120ms',icon:'⚡'},{label:'RAM Footprint',value:'-42%',icon:'🧠'}],technologies:[{name:'PyTorch'},{name:'TorchScript'},{name:'ONNX'},{name:'CoreML'}],features:['Quantization-aware training','Pruning + distillation','Operator fusion','Adaptive batching'],architecture:{title:'Pipeline',description:'Conversion + optimization + runtime interface',components:['Training Artifacts','Exporter','Quantizer','Runtime Adapter','Mobile Inference Engine']},github:null,demo:null},'pcnn-shadow':{title:'🌫️ Parallel CNN Shadow Detection',subtitle:'Image Segmentation CUDA',image:'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1200&q=80',description:'GPU-accelerated shadow segmentation.',longDescription:'Implements multi-stage CUDA kernels for illumination-invariant preprocessing and shadow mask refinement.',metrics:[{label:'Throughput',value:'240 FPS',icon:'🚀'}],technologies:[{name:'CUDA'},{name:'OpenCV'},{name:'C++'}],features:['Shared memory tiling','Warp divergence reduction','Histogram equalization'],architecture:{title:'Kernel Stages',description:'Pipeline of CUDA kernels',components:['Load & Normalize','Edge Enhance','Shadow Classify','Mask Refine']},github:null,demo:null},'iot-fpga':{title:'🔌 IoT Stream Analytics on FPGA',subtitle:'Low-Latency Edge Processing',image:'https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&w=1200&q=80',description:'Verilog + high-level synthesis for streaming analytics.',longDescription:'Designed a hybrid FPGA fabric for real-time sensor fusion and anomaly scoring with sub-millisecond latency.',metrics:[{label:'Latency',value:'<1ms',icon:'⏱️'}],technologies:[{name:'Verilog'},{name:'Vitis HLS'},{name:'MQTT'}],features:['AXI-stream pipeline','Fixed-point DSP blocks','Adaptive thresholding'],architecture:{title:'FPGA Blocks',description:'Stream-centric composition',components:['Ingress Parser','Preprocess DSP','Feature Extractor','Anomaly Core','Egress Formatter']},github:null,demo:null}};}renderProject(p){return`<article class="project-detail" style="max-width:1100px;margin:0 auto;">${p.image?`<div style=\"position:relative;aspect-ratio:16/9;overflow:hidden;border-radius:16px;margin:-1rem -1rem 1.25rem;background:#111;\"><img src="${p.image}" alt="${p.title}" style="width:100%;height:100%;object-fit:cover;"/></div>`:''}<h1 style="margin:.25rem 0 .35rem;font-size:clamp(1.6rem,3.2vw,2.4rem);line-height:1.1;">${p.title}</h1><p style="margin:0 0 1rem;color:var(--text-secondary);font-size:1rem;">${p.subtitle||''}</p><p style="margin:0 0 1.25rem;font-size:.95rem;line-height:1.5;">${p.longDescription||p.description||''}</p>${p.metrics?.length?`<section style=\"margin:0 0 1.75rem;\"><h2 style=\"font-size:1rem;letter-spacing:.06em;text-transform:uppercase;font-weight:600;margin:0 0 .75rem;opacity:.9;\">Key Metrics</h2><div style=\"display:grid;gap:.75rem;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));\">${p.metrics.map(m=>`<div style=\"padding:.85rem .9rem;background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.09);border-radius:12px;font-size:.75rem;letter-spacing:.05em;display:flex;flex-direction:column;gap:.35rem;\"><span style=\"font-size:1.1rem;\">${m.icon||''}</span><strong style=\"font-size:.9rem;\">${m.value}</strong><span style=\"opacity:.75;\">${m.label}</span></div>`).join('')}</div></section>`:''}${p.technologies?.length?`<section style=\"margin:0 0 1.75rem;\"><h2 style=\"font-size:1rem;letter-spacing:.06em;text-transform:uppercase;font-weight:600;margin:0 0 .75rem;opacity:.9;\">Technologies</h2><div style=\"display:flex;flex-wrap:wrap;gap:.5rem;\">${p.technologies.map(t=>`<span style=\"padding:.45rem .7rem;background:rgba(229,9,20,.15);color:var(--netflix-red,#e50914);font-size:.65rem;font-weight:500;letter-spacing:.05em;border:1px solid rgba(229,9,20,.35);border-radius:24px;\">${t.name}</span>`).join('')}</div></section>`:''}${p.features?.length?`<section style=\"margin:0 0 2rem;\"><h2 style=\"font-size:1rem;letter-spacing:.06em;text-transform:uppercase;font-weight:600;margin:0 0 .75rem;opacity:.9;\">Features</h2><ul style=\"padding:0;margin:0;list-style:none;display:grid;gap:.6rem;\">${p.features.map(f=>`<li style=\"display:flex;align-items:flex-start;gap:.55rem;font-size:.85rem;line-height:1.4;\"><span style=\"color:#4ade80;font-size:.9rem;position:relative;top:.15rem;\">✔</span><span>${f}</span></li>`).join('')}</ul></section>`:''}${(p.architecture?.components||[]).length?`<section style=\"margin:0 0 1rem;\"><h2 style=\"font-size:1rem;letter-spacing:.06em;text-transform:uppercase;font-weight:600;margin:0 0 .75rem;opacity:.9;\">${p.architecture.title}</h2><p style=\"margin:0 0 .85rem;font-size:.85rem;line-height:1.5;opacity:.9;\">${p.architecture.description||''}</p><ol style=\"margin:0;padding-left:1rem;font-size:.8rem;line-height:1.45;display:grid;gap:.4rem;\">${p.architecture.components.map(c=>`<li>${c}</li>`).join('')}</ol></section>`:''}${(p.github||p.demo)?`<footer style=\"margin:2rem 0 0;display:flex;gap:.9rem;flex-wrap:wrap;\">${p.github?`<a href=\"${p.github}\" target=\"_blank\" rel=\"noopener\" style=\"text-decoration:none;background:rgba(255,255,255,.09);border:1px solid rgba(255,255,255,.15);padding:.65rem .95rem;font-size:.7rem;letter-spacing:.06em;border-radius:8px;display:inline-flex;gap:.4rem;align-items:center;\">GitHub ↗</a>`:''}${p.demo?`<a href=\"${p.demo}\" target=\"_blank\" rel=\"noopener\" style=\"text-decoration:none;background:rgba(255,255,255,.09);border:1px solid rgba(255,255,255,.15);padding:.65rem .95rem;font-size:.7rem;letter-spacing:.06em;border-radius:8px;display:inline-flex;gap:.4rem;align-items:center;\">Live Demo ↗</a>`:''}</footer>`:''}</article>`;}}
  class NetflixHoverManager{constructor(){this.isTouch='ontouchstart'in window||navigator.maxTouchPoints>0;if(!this.isTouch){this.build();this.bind();}}build(){const c=document.createElement('div');c.className='netflix-preview-container';c.innerHTML=`<div class="netflix-preview-card"><div class="preview-image-container"><img class="preview-image" alt=""><div class="preview-overlay"><button class="preview-play-btn" aria-label="Open"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M8 5v14l11-7z"/></svg></button></div></div><div class="preview-content"><h3 class="preview-title"></h3><p class="preview-description"></p></div></div>`;document.body.appendChild(c);this.container=c;}bind(){document.addEventListener('mouseenter',e=>{const card=e.target.closest('.netflix-card[data-project]');card&&this.queueShow(card);},true);document.addEventListener('mouseleave',e=>{const card=e.target.closest('.netflix-card[data-project]');card&&this.hide();},true);this.container.addEventListener('click',()=>{if(this.active&&window.__projectDetailManager){window.__projectDetailManager.showProjectDetail(this.active.dataset.project,this.active);this.hide();}});document.addEventListener('click',()=>this.hide());}queueShow(card){clearTimeout(this.to);this.to=setTimeout(()=>this.show(card),400);}show(card){const data=window.__projectDetailManager?.getProjectData(card.dataset.project,card);if(!data)return;this.container.querySelector('.preview-image').src=data.image||'';this.container.querySelector('.preview-title').textContent=data.title||'';this.container.querySelector('.preview-description').textContent=data.description||'';const r=card.getBoundingClientRect();const el=this.container.querySelector('.netflix-preview-card');let left=r.left+r.width/2-200;left=Math.max(20,Math.min(left,window.innerWidth-420));let top=r.bottom+10;if(top+260>window.innerHeight-20)top=r.top-270;el.style.left=left+'px';el.style.top=top+'px';this.container.classList.add('active');this.active=card;}hide(){clearTimeout(this.to);this.container.classList.remove('active');this.active=null;}}
  // Certification dataset & rendering
  const __certifications={ 'aws-dev':{title:'AWS Certified Developer – Associate',organization:'Amazon Web Services',issued:'2024',image:'assets/aws.webp',description:'Develop, deploy, and debug AWS cloud-native apps.',skills:['Lambda','DynamoDB','API Gateway','S3','IAM'],credential:'https://www.credly.com/badges/91434a38-46c5-45f4-996a-e8753b95ac5b/public_url'}, 'gcp-llm-intro':{title:'Introduction to Large Language Models',organization:'Google Cloud',issued:'2024',image:'assets/googlecloud.jpg',description:'Foundational LLM architectures and prompting.',skills:['LLMs','Prompting','Embeddings'],credential:'https://www.coursera.org/account/accomplishments/certificate/V22EA82YJ55F'}, 'ibm-ml-regression':{title:'Supervised Machine Learning: Regression',organization:'IBM',issued:'2024',image:'assets/ibm.webp',description:'Regression modeling & evaluation techniques.',skills:['Regression','Evaluation','Regularization'],credential:'https://www.coursera.org/account/accomplishments/certificate/VAF2292SM6XN'}, 'gcp-genai-intro':{title:'Introduction to Generative AI',organization:'Google Cloud',issued:'2024',image:'assets/googlecloud.jpg',description:'Generative AI paradigms & diffusion basics.',skills:['Generative AI','Diffusion','Use Cases'],credential:'https://www.coursera.org/account/accomplishments/certificate/L9CS4VBC3V3P'}, 'broadcom-cloud':{title:'Cloud and Virtualization',organization:'Broadcom',issued:'2023',image:'assets/Broadcom-Logo.jpg',description:'Cloud infra & virtualization fundamentals.',skills:['Cloud','Virtualization','Infrastructure']}, 'broadcom-network-virt':{title:'Network Virtualization',organization:'Broadcom',issued:'2023',image:'assets/Broadcom-Logo.jpg',description:'SDN & overlay networking concepts.',skills:['Networking','Virtualization','SDN']}, 'broadcom-sds':{title:'Software Defined Storage',organization:'Broadcom',issued:'2023',image:'assets/Broadcom-Logo.jpg',description:'Distributed & software-defined storage.',skills:['Storage','SDS','Infrastructure']}};
  function renderCertificationDetail(id){const c=__certifications[id];if(!c)return'<div>Certification not found</div>';const skills=c.skills?.length?`<div style="display:flex;flex-wrap:wrap;gap:.5rem;margin:1.2rem 0 1.6rem;">${c.skills.map(s=>`<span style=\"background:#1e1e1e;border:1px solid #2a2a2a;padding:.45rem .65rem;border-radius:24px;font-size:.65rem;letter-spacing:.5px;color:#ddd;\">${s}</span>`).join('')}</div>`:'';const cred=c.credential?`<p style="margin:1.4rem 0 0;"><a href="${c.credential}" target="_blank" rel="noopener" style="text-decoration:none;background:#e50914;color:#fff;padding:.6rem .9rem;border-radius:6px;font-size:.7rem;letter-spacing:.5px;font-weight:600;display:inline-flex;align-items:center;gap:.4rem;">🔗 View Credential</a></p>`:'';return`<div class="cert-detail" data-cert="${id}"><h1 style="margin:.25rem 0 .35rem;font-size:clamp(1.5rem,3vw,2.2rem);line-height:1.15;">${c.title}</h1><p style="margin:0 0 1rem;color:#e50914;font-weight:600;font-size:.85rem;letter-spacing:.75px;">${c.organization} • ${c.issued}</p><p style="line-height:1.55;font-size:.95rem;margin:0 0 1.1rem;">${c.description}</p><h3 style="margin:2rem 0 .7rem;font-size:1.05rem;letter-spacing:.5px;">Skills Validated</h3>${skills||'<p style="font-size:.75rem;color:#777;">No skills listed.</p>'}${cred}</div>`;}
  function openCertification(id,push=true){const mgr=window.__projectDetailManager;if(!mgr||!__certifications[id])return;const modal=mgr.modal;const body=modal.querySelector('.project-modal-body');body.innerHTML=renderCertificationDetail(id);modal.classList.add('active');modal.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';const nav=modal.querySelector('.project-nav-bar');if(nav)nav.style.display='none';if(push)location.hash=`cert-${id}`;mgr.lastFocus=document.activeElement instanceof HTMLElement?document.activeElement:null;const closeBtn=modal.querySelector('.project-close');closeBtn&&closeBtn.focus();}
  function handleHash(){if(location.hash.startsWith('#project-')){window.__projectDetailManager?.onHashChange();}else if(location.hash.startsWith('#cert-')){openCertification(location.hash.replace('#cert-',''),false);} }
  function initializeAccessibility(){document.querySelectorAll('.netflix-card').forEach(card=>{card.setAttribute('tabindex','0');card.setAttribute('role','button');const t=card.querySelector('.netflix-card-title')?.textContent?.trim()||'details';card.setAttribute('aria-label','Open project '+t);});document.querySelectorAll('.cert-item[data-cert]').forEach(card=>{card.setAttribute('tabindex','0');card.setAttribute('role','button');const h=card.querySelector('h3')?.textContent?.trim()||'details';card.setAttribute('aria-label','Open certification '+h);});}
  // Provide public accessor for dynamic listings (e.g., work.html grid)
  ProjectDetailManager.prototype.getAllProjects=function(){ if(!this._data) this._data=this.staticData(); return this._data; };
  window.addEventListener('DOMContentLoaded',()=>{document.body.classList.add('loaded');initializeHeaderEffects();initializeCarousels();window.__projectDetailManager=new ProjectDetailManager();new NetflixHoverManager();initializeAccessibility();document.addEventListener('click',e=>{const cert=e.target.closest('.cert-item[data-cert]');if(cert)openCertification(cert.getAttribute('data-cert'));});window.addEventListener('hashchange',handleHash);handleHash();console.log('[Init] main.js loaded (projects + certifications)');});
})();
